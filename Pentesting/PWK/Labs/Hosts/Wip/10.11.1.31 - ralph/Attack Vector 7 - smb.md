Attack Vector 7 - smb

# NMAP scans




SMB Stuff
# Enumerate hostname
`nmblookup -A 10.11.1.31`
![92acd445f3799b485d7fff6be504ea25.png](114601604c8343828294556b208d14f9.png)

# List shares
`smbmap -H 10.11.1.31`
![bcda53b74c88a10b0d8fc5ead9274e8f.png](b0287c5287c04e90bc206f693d693408.png)

`smbmap -H 10.11.1.31 -P 139`
![b7e39ae0315deb508eb1f7ab92948d02.png](cd6037d809a14e5bb709c90e1f53541f.png)

`echo exit | smbclient -L \\\\10.11.1.31`
![df336c26e001b0d55b9080937acf6867.png](1bd94f3057d04262b4ed97322068359a.png)

`sudo nmap --script smb-enum-shares -p 139,445 10.11.1.31`
![4bb4a913b2823a5a1bcbe61f703c86e4.png](3e9b362001b24b92b474e31b6cb5d8a9.png)

# Check Null sessions
`rpcclient -U "" -N 10.11.1.31`
`enumprivs`
`netshareenum`
`srvinfo`
`lookupnames root`
`lookupsids `
![8df414662cef59d06280fd13eb12b237.png](aa7cba3671424ad68cf5c237a477654b.png)

`echo exit | smbclient -L \\\\10.11.1.31\\print$`

`echo exit | smbclient -L \\\\10.11.1.31\\IPC$`


# Check for Vulnerabilities
`sudo nmap --script smb-vuln* -p 139,445 10.11.1.31`


# Overall scan
`enum4linux -a 10.11.1.31`


`smbclient \\\\10.11.1.31\\IPC$`


`smbclient \\\\10.11.1.31\\printer$`


Open Wireshark then run:
`echo exit | smbclient -L 10.11.1.31`

