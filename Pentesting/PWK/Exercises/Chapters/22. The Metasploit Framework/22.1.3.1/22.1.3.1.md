22.1.3.1

# 22.1.3.1.1. Start the postgresql service and launch msfconsole. 

Start the postgresql service
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/22_metasploitFramework$ sudo systemctl start postgresql
[sudo] password for kali: 
```
Launch the msfconsole
```plaintext
kali@kali:~/gitWorkspace/pwk/oscpExercises/22_metasploitFramework$ sudo msfconsole -q
msf5 > 
```

# 22.1.3.1.2. Use the SMB, HTTP, and any other interesting auxiliary modules to scan the lab systems.

I will use a file that contains 50 hosts from the public machine domain of the pwk labs

module: auxiliary(scanner/smb/smb2)
```plaintext
msf5 > search type:auxiliary name:smb

Matching Modules
================

   #   Name                                                        Disclosure Date  Rank    Check  Description
   -   ----                                                        ---------------  ----    -----  -----------
   0   auxiliary/admin/oracle/ora_ntlm_stealer                     2009-04-07       normal  No     Oracle SMB Relay Code Execution
   1   auxiliary/admin/smb/check_dir_file                                           normal  No     SMB Scanner Check File/Directory Utility
   2   auxiliary/admin/smb/delete_file                                              normal  No     SMB File Delete Utility
...
   24  auxiliary/scanner/smb/smb1                                                   normal  No     SMBv1 Protocol Detection
   25  auxiliary/scanner/smb/smb2                                                   normal  No     SMB 2.0 Protocol Detection
...
msf5 > use 25
msf5 auxiliary(scanner/smb/smb2) > options

Module options (auxiliary/scanner/smb/smb2):

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOSTS                    yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    445              yes       The target port (TCP)
   THREADS  1                yes       The number of concurrent threads (max one per host)

msf5 auxiliary(scanner/smb/smb2) > set rhosts /home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets
msf5 auxiliary(scanner/smb/smb2) > set rhosts file:/home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets
rhosts => file:/home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets
msf5 auxiliary(scanner/smb/smb2) > run

[+] 10.11.1.13:445        - 10.11.1.13 supports SMB 2 [dialect 255.2] and has been online for 2270 hours
[*] Scanned  5 of 50 hosts (10% complete)
[+] 10.11.1.20:445        - 10.11.1.20 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[+] 10.11.1.21:445        - 10.11.1.21 supports SMB 2 [dialect 255.2] and has been online for 5757 hours
[+] 10.11.1.22:445        - 10.11.1.22 supports SMB 2 [dialect 255.2] and has been online for 5756 hours
[+] 10.11.1.24:445        - 10.11.1.24 supports SMB 2 [dialect 255.2] and has been online for 5756 hours
[*] Scanned 10 of 50 hosts (20% complete)
[+] 10.11.1.31:445        - 10.11.1.31 supports SMB 2 [dialect 255.2] and has been online for 6287 hours
[*] Scanned 15 of 50 hosts (30% complete)
[+] 10.11.1.73:445        - 10.11.1.73 supports SMB 2 [dialect 255.2] and has been online for 6289 hours
[+] 10.11.1.75:445        - 10.11.1.75 supports SMB 2 [dialect 255.2] and has been online for 6289 hours
[*] Scanned 20 of 50 hosts (40% complete)
[+] 10.11.1.101:445       - 10.11.1.101 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[+] 10.11.1.111:445       - 10.11.1.111 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[*] Scanned 25 of 50 hosts (50% complete)
[+] 10.11.1.120:445       - 10.11.1.120 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[+] 10.11.1.121:445       - 10.11.1.121 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[+] 10.11.1.122:445       - 10.11.1.122 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[+] 10.11.1.123:445       - 10.11.1.123 supports SMB 2 [dialect 255.2] and has been online for 6274 hours
[+] 10.11.1.128:445       - 10.11.1.128 supports SMB 2 [dialect 255.2] and has been online for 5790 hours
[*] Scanned 30 of 50 hosts (60% complete)
[+] 10.11.1.146:445       - 10.11.1.146 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[*] Scanned 35 of 50 hosts (70% complete)
[+] 10.11.1.220:445       - 10.11.1.220 supports SMB 2 [dialect 255.2] and has been online for -1 hours
[+] 10.11.1.222:445       - 10.11.1.222 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[+] 10.11.1.223:445       - 10.11.1.223 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[*] Scanned 40 of 50 hosts (80% complete)
[+] 10.11.1.231:445       - 10.11.1.231 supports SMB 2 [dialect 255.2] and has been online for 3679678 hours
[*] Scanned 45 of 50 hosts (90% complete)
[*] Scanned 50 of 50 hosts (100% complete)
[*] Auxiliary module execution completed
```

module: auxiliary(scanner/smb/smb1)
```plaintext
msf5 auxiliary(scanner/smb/smb1) > options

Module options (auxiliary/scanner/smb/smb1):

   Name     Current Setting                                                     Required  Description
   ----     ---------------                                                     --------  -----------
   RHOSTS   file:/home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    445                                                                 yes       The target port (TCP)
   THREADS  1                                                                   yes       The number of concurrent threads (max one per host)

msf5 auxiliary(scanner/smb/smb1) > run

[+] 10.11.1.5:445         - 10.11.1.5 supports SMBv1 dialect.
[+] 10.11.1.8:445         - 10.11.1.8 supports SMBv1 dialect.
[+] 10.11.1.13:445        - 10.11.1.13 supports SMBv1 dialect.
[*] Scanned  5 of 50 hosts (10% complete)
[+] 10.11.1.21:445        - 10.11.1.21 supports SMBv1 dialect.
[+] 10.11.1.22:445        - 10.11.1.22 supports SMBv1 dialect.
[+] 10.11.1.24:445        - 10.11.1.24 supports SMBv1 dialect.
[*] Scanned 10 of 50 hosts (20% complete)
[+] 10.11.1.31:445        - 10.11.1.31 supports SMBv1 dialect.
[*] Scanned 15 of 50 hosts (30% complete)
[+] 10.11.1.73:445        - 10.11.1.73 supports SMBv1 dialect.
[+] 10.11.1.75:445        - 10.11.1.75 supports SMBv1 dialect.
[*] Scanned 20 of 50 hosts (40% complete)
[+] 10.11.1.101:445       - 10.11.1.101 supports SMBv1 dialect.
[*] Scanned 25 of 50 hosts (50% complete)
[+] 10.11.1.123:445       - 10.11.1.123 supports SMBv1 dialect.
[+] 10.11.1.128:445       - 10.11.1.128 supports SMBv1 dialect.
[*] Scanned 30 of 50 hosts (60% complete)
[+] 10.11.1.136:445       - 10.11.1.136 supports SMBv1 dialect.
[+] 10.11.1.146:445       - 10.11.1.146 supports SMBv1 dialect.
[*] Scanned 35 of 50 hosts (70% complete)
[+] 10.11.1.220:445       - 10.11.1.220 supports SMBv1 dialect.
[*] Scanned 40 of 50 hosts (80% complete)
[+] 10.11.1.227:445       - 10.11.1.227 supports SMBv1 dialect.
[+] 10.11.1.231:445       - 10.11.1.231 supports SMBv1 dialect.
[*] Scanned 45 of 50 hosts (90% complete)
[*] Scanned 50 of 50 hosts (100% complete)
[*] Auxiliary module execution completed
```

module: auxiliary(scanner/smb/smb_enumusers)
```plaintext
msf5 auxiliary(scanner/smb/smb_enumusers) > options

Module options (auxiliary/scanner/smb/smb_enumusers):

   Name          Current Setting                                                     Required  Description
   ----          ---------------                                                     --------  -----------
   DB_ALL_USERS  true                                                                no        Add all enumerated usernames to the database
   RHOSTS        file:/home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   SMBDomain     .                                                                   no        The Windows domain to use for authentication
   SMBPass                                                                           no        The password for the specified username
   SMBUser                                                                           no        The username to authenticate as
   THREADS       10                                                                  yes       The number of concurrent threads (max one per host)

msf5 auxiliary(scanner/smb/smb_enumusers) > run

[+] 10.11.1.8:139         - PHOENIX [  ] ( LockoutTries=0 PasswordMin=5 )
[*] Scanned  7 of 50 hosts (14% complete)
Error: 10.11.1.31 Rex::Proto::DCERPC::Exceptions::Fault DCERPC FAULT => nca_s_fault_access_denied
[*] Scanned 16 of 50 hosts (32% complete)
Error: 10.11.1.115 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=47 WordCount=0)
[+] 10.11.1.75:445        - BRUCE [  ] 
[+] 10.11.1.101:139       - BREAK [  ] ( LockoutTries=0 PasswordMin=5 )
[*] Scanned 24 of 50 hosts (48% complete)
[+] 10.11.1.136:139       - SUFFERANCE [ games, nobody, proxy, www-data, root, news, bin, mail, daemon, sshd, man, lp, Debian-exim, gnats, backup, sys, bob, identd, list, irc, statd, sync, uucp ] ( LockoutTries=0 PasswordMin=5 )
[+] 10.11.1.146:139       - SUSIE [  ] ( LockoutTries=0 PasswordMin=5 )
[*] Scanned 33 of 50 hosts (66% complete)
[+] 10.11.1.227:445       - JD [ admin, Administrator, backup, david, gary, Guest, homer, IUSR_SRV2, IWAM_SRV2, john, lee, lisa, mark, ned, nick, simon, sqlusr, todd, TsInternetUser ] ( LockoutTries=0 PasswordMin=0 )
[*] Scanned 40 of 50 hosts (80% complete)
[+] 10.11.1.231:139       - MAILMAN [  ] ( LockoutTries=0 PasswordMin=5 )
[*] Scanned 46 of 50 hosts (92% complete)
[*] Scanned 49 of 50 hosts (98% complete)
[*] Scanned 50 of 50 hosts (100% complete)
[*] Auxiliary module execution completed
```

module: auxiliary(scanner/smb/smb_ms17_010)
```plaintext
msf5 auxiliary(scanner/smb/smb_ms17_010) > options

Module options (auxiliary/scanner/smb/smb_ms17_010):

   Name         Current Setting                                                     Required  Description
   ----         ---------------                                                     --------  -----------
   CHECK_ARCH   true                                                                no        Check for architecture on vulnerable hosts
   CHECK_DOPU   true                                                                no        Check for DOUBLEPULSAR on vulnerable hosts
   CHECK_PIPE   false                                                               no        Check for named pipe on vulnerable hosts
   NAMED_PIPES  /usr/share/metasploit-framework/data/wordlists/named_pipes.txt      yes       List of named pipes to check
   RHOSTS       file:/home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT        445                                                                 yes       The SMB service port (TCP)
   SMBDomain    .                                                                   no        The Windows domain to use for authentication
   SMBPass                                                                          no        The password for the specified username
   SMBUser                                                                          no        The username to authenticate as
   THREADS      10                                                                  yes       The number of concurrent threads (max one per host)

msf5 auxiliary(scanner/smb/smb_ms17_010) > run

[-] 10.11.1.20:445        - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.8:445         - Host does NOT appear vulnerable.
[-] 10.11.1.21:445        - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.13:445        - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.24:445        - Host does NOT appear vulnerable.
[-] 10.11.1.22:445        - Host does NOT appear vulnerable.
[+] 10.11.1.5:445         - Host is likely VULNERABLE to MS17-010! - Windows 5.1 x86 (32-bit)
[*] Scanned  7 of 50 hosts (14% complete)
[-] 10.11.1.31:445        - Host does NOT appear vulnerable.
[*] Scanned 14 of 50 hosts (28% complete)
[*] Scanned 16 of 50 hosts (32% complete)
[-] 10.11.1.111:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.120:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.73:445        - Host does NOT appear vulnerable.
[-] 10.11.1.101:445       - Host does NOT appear vulnerable.
[+] 10.11.1.75:445        - Host is likely VULNERABLE to MS17-010! - Windows 8.1 Enterprise 9600 x64 (64-bit)
[*] Scanned 24 of 50 hosts (48% complete)
[-] 10.11.1.121:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.122:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.123:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.136:445       - Host does NOT appear vulnerable.
[-] 10.11.1.128:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.146:445       - Host does NOT appear vulnerable.
[*] Scanned 32 of 50 hosts (64% complete)
[*] Scanned 33 of 50 hosts (66% complete)
[-] 10.11.1.223:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.222:445       - An SMB Login Error occurred while connecting to the IPC$ tree.
[-] 10.11.1.220:445       - Host does NOT appear vulnerable.
[+] 10.11.1.227:445       - Host is likely VULNERABLE to MS17-010! - Windows 5.0 x86 (32-bit)
[*] Scanned 40 of 50 hosts (80% complete)
[-] 10.11.1.231:445       - Host does NOT appear vulnerable.
[*] Scanned 44 of 50 hosts (88% complete)
[*] Scanned 45 of 50 hosts (90% complete)
[*] Scanned 50 of 50 hosts (100% complete)
[*] Auxiliary module execution completed
```

module: auxiliary(scanner/rdp/rdp_scanner)
```plaintext
msf5 auxiliary(scanner/rdp/rdp_scanner) > run

[*] 10.11.1.7:3389        - Detected RDP on 10.11.1.7:3389        (Windows version: 10.0.17134) (Requires NLA: No)
[*] 10.11.1.13:3389       - Detected RDP on 10.11.1.13:3389       (Windows version: 6.3.9600) (Requires NLA: No)
[*] Scanned  5 of 50 hosts (10% complete)
[*] 10.11.1.20:3389       - Detected RDP on 10.11.1.20:3389       (Windows version: 10.0.17763) (Requires NLA: No)
[*] 10.11.1.21:3389       - Detected RDP on 10.11.1.21:3389       (Windows version: 10.0.14393) (Requires NLA: No)
[*] 10.11.1.22:3389       - Detected RDP on 10.11.1.22:3389       (Windows version: 10.0.14393) (Requires NLA: No)
[*] 10.11.1.24:3389       - Detected RDP on 10.11.1.24:3389       (Windows version: 10.0.14393) (Requires NLA: No)
[*] Scanned 10 of 50 hosts (20% complete)
[*] 10.11.1.31:3389       - Detected RDP on 10.11.1.31:3389       (Windows version: 10.0.14393) (Requires NLA: No)
[*] Scanned 15 of 50 hosts (30% complete)
[*] 10.11.1.75:3389       - Detected RDP on 10.11.1.75:3389       (Windows version: 6.3.9600) (Requires NLA: No)
[*] 10.11.1.79:3389       - Detected RDP on 10.11.1.79:3389       (Windows version: 10.0.17763) (Requires NLA: No)
[*] Scanned 20 of 50 hosts (40% complete)
[*] 10.11.1.111:3389      - Detected RDP on 10.11.1.111:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] 10.11.1.118:3389      - Detected RDP on 10.11.1.118:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] Scanned 25 of 50 hosts (50% complete)
[*] 10.11.1.120:3389      - Detected RDP on 10.11.1.120:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] 10.11.1.121:3389      - Detected RDP on 10.11.1.121:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] 10.11.1.122:3389      - Detected RDP on 10.11.1.122:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] 10.11.1.123:3389      - Detected RDP on 10.11.1.123:3389      (Windows version: 10.0.14393) (Requires NLA: No)
[*] 10.11.1.128:3389      - Detected RDP on 10.11.1.128:3389      (Windows version: 6.3.9600) (Requires NLA: No)
[*] Scanned 30 of 50 hosts (60% complete)
[*] Scanned 35 of 50 hosts (70% complete)
[*] 10.11.1.220:3389      - Detected RDP on 10.11.1.220:3389      (Windows version: 6.1.7601) (Requires NLA: No)
[*] 10.11.1.221:3389      - Detected RDP on 10.11.1.221:3389      (Windows version: 10.0.14393) (Requires NLA: No)
[*] 10.11.1.222:3389      - Detected RDP on 10.11.1.222:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] 10.11.1.223:3389      - Detected RDP on 10.11.1.223:3389      (Windows version: 10.0.17763) (Requires NLA: No)
[*] Scanned 40 of 50 hosts (80% complete)
[*] 10.11.1.229:3389      - Detected RDP on 10.11.1.229:3389      (Windows version: 10.0.14393) (Requires NLA: No)
[*] Scanned 45 of 50 hosts (90% complete)
[*] 10.11.1.247:3389      - Detected RDP on 10.11.1.247:3389      (Windows version: 6.3.9600) (Requires NLA: No)
[*] Scanned 50 of 50 hosts (100% complete)
[*] Auxiliary module execution completed
```

```plaintext
msf5 auxiliary(scanner/http/webdav_scanner) > options

Module options (auxiliary/scanner/http/webdav_scanner):

   Name     Current Setting                                                     Required  Description
   ----     ---------------                                                     --------  -----------
   PATH     /                                                                   yes       Path to use
   Proxies                                                                      no        A proxy chain of format type:host:port[,type:host:port][...]
   RHOSTS   file:/home/kali/gitWorkspace/pwk/results/targets/pwk/sortedTargets  yes       The target host(s), range CIDR identifier, or hosts file with syntax 'file:<path>'
   RPORT    80                                                                  yes       The target port (TCP)
   SSL      false                                                               no        Negotiate SSL/TLS for outgoing connections
   THREADS  10                                                                  yes       The number of concurrent threads (max one per host)
   VHOST                                                                        no        HTTP server virtual host
msf5 auxiliary(scanner/http/webdav_scanner) > run

[*] 10.11.1.8 (Apache/2.0.52 (CentOS)) WebDAV disabled.
[*] 10.11.1.31 (Microsoft-IIS/10.0) WebDAV disabled.
[*] 10.11.1.21 (Microsoft-IIS/10.0) WebDAV disabled.
[*] 10.11.1.10 (Microsoft-IIS/6.0) WebDAV disabled.
[+] 10.11.1.14 (Microsoft-IIS/5.1) has WEBDAV ENABLED
[*] Scanned 11 of 50 hosts (22% complete)
[*] 10.11.1.50 (Microsoft-IIS/8.5) WebDAV disabled.
[*] 10.11.1.101 (Apache/2.4.18 (Ubuntu)) WebDAV disabled.
[*] 10.11.1.35 (Apache/2.4.6 (CentOS) PHP/5.4.16) WebDAV disabled.
[*] Scanned 16 of 50 hosts (32% complete)
[*] 10.11.1.72 (Apache/2.2.20 (Ubuntu)) WebDAV disabled.
[*] 10.11.1.39 (nginx/1.6.3) WebDAV disabled.
[*] Scanned 20 of 50 hosts (40% complete)
[*] 10.11.1.115 (Apache/2.0.40 (Red Hat Linux)) WebDAV disabled.
[*] 10.11.1.116 (Apache/2.4.18 (Ubuntu)) WebDAV disabled.
[*] Scanned 29 of 50 hosts (57% complete)
[*] 10.11.1.133 (Microsoft IIS 5.6) WebDAV disabled.
[*] Scanned 37 of 50 hosts (74% complete)
[+] 10.11.1.227 (Microsoft-IIS/5.0) has WEBDAV ENABLED
[*] 10.11.1.229 (Microsoft-IIS/10.0) WebDAV disabled.
[*] 10.11.1.223 (Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40) WebDAV disabled.
[*] 10.11.1.237 (Apache/2.2.22 (Debian)) WebDAV disabled.
[*] 10.11.1.234 (Apache/2.2.14 (Ubuntu)) WebDAV disabled.
[*] Scanned 44 of 50 hosts (88% complete)
[*] Scanned 45 of 50 hosts (90% complete)
[*] 10.11.1.251 (Apache/2.4.29 (Ubuntu)) WebDAV disabled.
[*] Scanned 47 of 50 hosts (94% complete)
[*] Scanned 48 of 50 hosts (96% complete)
[*] 10.11.1.250 (Apache/2.4.18 (Ubuntu)) WebDAV disabled.
[*] Scanned 50 of 50 hosts (100% complete)
[*] Auxiliary module execution completed
```


# 22.1.3.1.3. Review the hosts' information in the database.

Look for hosts that run smb on port 445
```plaintext
msf5 auxiliary(scanner/rdp/rdp_scanner) > services -p 445
Services
========

host            port  proto  name  state  info
----            ----  -----  ----  -----  ----
10.11.1.5       445   tcp    smb1  open   
10.11.1.8       445   tcp    smb1  open   
10.11.1.13      445   tcp    smb1  open   
10.11.1.20      445   tcp    smb2  open   
10.11.1.21      445   tcp    smb1  open   
10.11.1.22      445   tcp    smb1  open   
10.11.1.24      445   tcp    smb1  open   
10.11.1.31      445   tcp    smb1  open   
10.11.1.73      445   tcp    smb1  open   
10.11.1.75      445   tcp    smb1  open   
10.11.1.101     445   tcp    smb1  open   
10.11.1.111     445   tcp    smb2  open   
10.11.1.120     445   tcp    smb2  open   
10.11.1.121     445   tcp    smb2  open   
10.11.1.122     445   tcp    smb2  open   
10.11.1.123     445   tcp    smb1  open   
10.11.1.128     445   tcp    smb1  open   
10.11.1.136     445   tcp    smb1  open   
10.11.1.146     445   tcp    smb1  open   
10.11.1.220     445   tcp    smb1  open   
10.11.1.222     445   tcp    smb2  open   
10.11.1.223     445   tcp    smb2  open   
10.11.1.227     445   tcp    smb   open   
10.11.1.231     445   tcp    smb1  open   
192.168.214.10  445   tcp    smb   open 
```

Find the hosts with rdp port 3389 open
```plaintext
msf5 auxiliary(scanner/rdp/rdp_scanner) > services -p 3389
Services
========

host            port  proto  name  state  info
----            ----  -----  ----  -----  ----
10.11.1.7       3389  tcp    rdp   open   Requires NLA: No
10.11.1.13      3389  tcp    rdp   open   Requires NLA: No
10.11.1.20      3389  tcp    rdp   open   Requires NLA: No
10.11.1.21      3389  tcp    rdp   open   Requires NLA: No
10.11.1.22      3389  tcp    rdp   open   Requires NLA: No
10.11.1.24      3389  tcp    rdp   open   Requires NLA: No
10.11.1.31      3389  tcp    rdp   open   Requires NLA: No
10.11.1.75      3389  tcp    rdp   open   Requires NLA: No
10.11.1.79      3389  tcp    rdp   open   Requires NLA: No
10.11.1.111     3389  tcp    rdp   open   Requires NLA: No
10.11.1.118     3389  tcp    rdp   open   Requires NLA: No
10.11.1.120     3389  tcp    rdp   open   Requires NLA: No
10.11.1.121     3389  tcp    rdp   open   Requires NLA: No
10.11.1.122     3389  tcp    rdp   open   Requires NLA: No
10.11.1.123     3389  tcp    rdp   open   Requires NLA: No
10.11.1.128     3389  tcp    rdp   open   Requires NLA: No
10.11.1.220     3389  tcp    rdp   open   Requires NLA: No
10.11.1.221     3389  tcp    rdp   open   Requires NLA: No
10.11.1.222     3389  tcp    rdp   open   Requires NLA: No
10.11.1.223     3389  tcp    rdp   open   Requires NLA: No
10.11.1.229     3389  tcp    rdp   open   Requires NLA: No
10.11.1.247     3389  tcp    rdp   open   Requires NLA: No
192.168.214.10  3389  tcp          open  
```

Find webdav
```plaintext
msf5 auxiliary(scanner/http/webdav_scanner) > services -s webdav
Services
========

host            port  proto  name  state  info
----            ----  -----  ----  -----  ----
10.11.1.5       445   tcp    smb1  open   
10.11.1.7       3389  tcp    rdp   open   Requires NLA: No
10.11.1.8       80    tcp    http  open   Apache/2.0.52 (CentOS)
10.11.1.8       139   tcp          open   
10.11.1.8       445   tcp    smb1  open   
10.11.1.10      80    tcp    http  open   Microsoft-IIS/6.0
10.11.1.13      445   tcp    smb1  open   
10.11.1.13      3389  tcp    rdp   open   Requires NLA: No
10.11.1.14      80    tcp    http  open   Microsoft-IIS/5.1
10.11.1.20      445   tcp    smb2  open   
10.11.1.20      3389  tcp    rdp   open   Requires NLA: No
10.11.1.21      80    tcp    http  open   Microsoft-IIS/10.0
10.11.1.21      445   tcp    smb1  open   
10.11.1.21      3389  tcp    rdp   open   Requires NLA: No
10.11.1.22      445   tcp    smb1  open   
10.11.1.22      3389  tcp    rdp   open   Requires NLA: No
10.11.1.24      445   tcp    smb1  open   
10.11.1.24      3389  tcp    rdp   open   Requires NLA: No
10.11.1.31      80    tcp    http  open   Microsoft-IIS/10.0 ( Powered by ASP.NET )
10.11.1.31      445   tcp    smb1  open   
10.11.1.31      3389  tcp    rdp   open   Requires NLA: No
10.11.1.35      80    tcp    http  open   Apache/2.4.6 (CentOS) PHP/5.4.16
10.11.1.39      80    tcp    http  open   nginx/1.6.3
10.11.1.50      80    tcp    http  open   Microsoft-IIS/8.5
10.11.1.72      80    tcp    http  open   Apache/2.2.20 (Ubuntu)
10.11.1.72      110   tcp    pop3  open   +OK beta POP3 server (JAMES POP3 Server 2.3.2) ready
10.11.1.73      445   tcp    smb1  open   
10.11.1.75      445   tcp    smb1  open   
10.11.1.75      3389  tcp    rdp   open   Requires NLA: No
10.11.1.79      3389  tcp    rdp   open   Requires NLA: No
10.11.1.101     80    tcp    http  open   Apache/2.4.18 (Ubuntu)
10.11.1.101     139   tcp          open   
10.11.1.101     445   tcp    smb1  open   
10.11.1.111     445   tcp    smb2  open   
10.11.1.111     3389  tcp    rdp   open   Requires NLA: No
10.11.1.115     80    tcp    http  open   Apache/2.0.40 (Red Hat Linux)
10.11.1.116     80    tcp    http  open   Apache/2.4.18 (Ubuntu)
10.11.1.118     3389  tcp    rdp   open   Requires NLA: No
10.11.1.120     445   tcp    smb2  open   
10.11.1.120     3389  tcp    rdp   open   Requires NLA: No
10.11.1.121     445   tcp    smb2  open   
10.11.1.121     3389  tcp    rdp   open   Requires NLA: No
10.11.1.122     445   tcp    smb2  open   
10.11.1.122     3389  tcp    rdp   open   Requires NLA: No
10.11.1.123     445   tcp    smb1  open   
10.11.1.123     3389  tcp    rdp   open   Requires NLA: No
10.11.1.128     445   tcp    smb1  open   
10.11.1.128     3389  tcp    rdp   open   Requires NLA: No
10.11.1.133     80    tcp    http  open   Microsoft IIS 5.6
10.11.1.136     139   tcp    smb   open   
10.11.1.136     445   tcp    smb1  open   
10.11.1.146     139   tcp          open   
10.11.1.146     445   tcp    smb1  open   
10.11.1.217     110   tcp    pop3  open   +OK example.com Cyrus POP3 v2.3.7-Invoca-RPM-2.3.7-7.el5_6.4 server ready <4053726982.1597170223@example.com>
10.11.1.220     445   tcp    smb1  open   
10.11.1.220     3389  tcp    rdp   open   Requires NLA: No
10.11.1.221     3389  tcp    rdp   open   Requires NLA: No
10.11.1.222     445   tcp    smb2  open   
10.11.1.222     3389  tcp    rdp   open   Requires NLA: No
10.11.1.223     80    tcp    http  open   Apache/2.4.38 (Win64) OpenSSL/1.0.2q PHP/5.6.40 ( Powered by PHP/5.6.40 )
10.11.1.223     445   tcp    smb2  open   
10.11.1.223     3389  tcp    rdp   open   Requires NLA: No
10.11.1.227     80    tcp    http  open   Microsoft-IIS/5.0
10.11.1.227     445   tcp    smb   open   
10.11.1.229     80    tcp    http  open   Microsoft-IIS/10.0 ( Powered by ASP.NET )
10.11.1.229     110   tcp    pop3  open   +OK POP3
10.11.1.229     3389  tcp    rdp   open   Requires NLA: No
10.11.1.231     139   tcp          open   
10.11.1.231     445   tcp    smb1  open   
10.11.1.234     80    tcp    http  open   Apache/2.2.14 (Ubuntu) ( Powered by PHP/5.3.2-1ubuntu4 )
10.11.1.237     80    tcp    http  open   Apache/2.2.22 (Debian)
10.11.1.247     3389  tcp    rdp   open   Requires NLA: No
10.11.1.250     80    tcp    http  open   Apache/2.4.18 (Ubuntu)
10.11.1.251     80    tcp    http  open   Apache/2.4.29 (Ubuntu)
192.168.214.10  80    tcp          open   
192.168.214.10  135   tcp          open   
192.168.214.10  443   tcp          open   
192.168.214.10  445   tcp    smb   open   
192.168.214.10  3306  tcp          open   
192.168.214.10  3389  tcp          open   
192.168.214.10  5040  tcp          open   
192.168.214.10  8895  tcp          open   
```