Nmap

Nmap



![2856e1555f5b70955abf1d599f7bdb1c.png](../../../../../_resources/12af039cdf444da4a2c84b15ccfcee30.png)


1. Scan for netbios
`sudo nmap -p445 -sV 192.168.132.42`

![6956ec7eb71dae176615afc7b13dca95.png](../../../../../_resources/9e0ece3ad37d434f8e08181545cb3856.png)



2. SMB OS discovery
`sudo nmap -p445 --script=smb-os-discovery 192.168.132.42`
![28cd42b672c9c29e4f836f1a5d7eafcd.png](../../../../../_resources/7da9e3819dee48f8bd9e1e0374597334.png)



3. SMB Protocol
`sudo nmap -p445 --script smb-protocols 192.168.132.42`
![20bb9467da1dfff3656b3e288ca9a64e.png](../../../../../_resources/c6020097b6d046a8860135e343dc9aed.png)



4. List shares
`sudo nmap --script smb-enum-shares -p445 <targetIp>`
![fd6382b976e94bd86dbe783a9eb1d074.png](../../../../../_resources/fd845809be7144b4b57b6f81237fde2e.png)



5. Default NSE Scripts
`sudo nmap -p445 -sC -sV 192.168.132.42`
![18871220e0dfdc8f0a0c97c78f06fcac.png](../../../../../_resources/27494d1d8abb4cc1a81693001cdbbd60.png)



6. Run all the smb enumeration scripts
`sudo nmap -p445 --script "smb-enum*" 192.168.132.42`
![b57421c9cf3a94e3e049a0b98f904da0.png](../../../../../_resources/cc8adcbe367445a8b853c76e72b649f2.png)



7. Run all smb vulnerable scripts
`sudo nmap -p445 --script "smb*vuln*" 192.168.132.42`
![d706356d0106f41951742b36b8d3237c.png](../../../../../_resources/a202923a354e42ae8f821951f700c22c.png)
