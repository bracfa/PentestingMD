TCP Ports

TCP Ports

1. Get closed and open ports using SYN Stealth scan. 
`sudo nmap -p- 192.168.200.40`
![cab6a18b0cfec7d15545ebceffd05201.png](../../../../../_resources/8ed6bca87ea343bf984e65a9ffb4e64a.png)

-We see open ports 53,135,139,445,3389,5357,49152,49153,49154,49155,49156,49157,49158


2. Scan only the open ports for service detection
`sudo nmap -p53,135,139,445,3389,5357,49152,49153,49154,49155,49156,49157,49158 -sV 192.168.200.40`
![14a1dace7e8054be7edf4ffaf140b8a4.png](../../../../../_resources/eceea1bcceb9405db588cb1e680f0ccb.png)

-We see DNS version, alot of MS Windows RPC ports, port 445 has a workgroup, and port 3389 does not have any version. It is likely a Windows machine


3. Run aggressive scan on the open ports
`sudo nmap -p53,135,139,445,3389,5357,49152,49153,49154,49155,49156,49157,49158 -A 192.168.200.40`
![8ebac5dbe2cd19c251b718ab8e61a753.png](../../../../../_resources/6141033322cd4ca98001046df2522c7d.png)
![bdaa039d2532567a9fe30eba65ca6c27.png](../../../../../_resources/93ca3392ab444f0697b1e547d25a3050.png)

-We have a Windows Server version: Windows Server  2008 Standard 6001 Service Pack 1


4. Run the Nmap NSE scripts for default,safe,auth,vuln
`sudo nmap -p53,135,139,445,3389,5357,49152,49153,49154,49155,49156,49157,49158 --script default,safe,auth,vuln 192.168.200.40`
![d094ed69c13154579f43ca286d481663.png](../../../../../_resources/0025cddf01f646b2ac239234e7a4fb90.png)
![f7837747c976d5fd4c8e4ae35408f715.png](../../../../../_resources/48890bf7984b48079549059c5fc679b4.png)
![84a2a4108647d29869111aa830f6526b.png](../../../../../_resources/437f43ecca89497ca02049632d2b1032.png)
![6364f9f002c667eb0736b58636f234f3.png](../../../../../_resources/a3a541b9417c40b59e6573420566068c.png)
![4ccd048f5200045c26a52af328d64e32.png](../../../../../_resources/f1606390a9dc4e889daa3900f7a93cac.png)
![090d9fda1f3875a48f8a9a0dc31e196f.png](../../../../../_resources/a24eee7c6e374a8ba09291e2ed6aad64.png)

-port 3389 vulnerable to MS12-020 RDP DOS
-port 3389 vulnerable to MS12-020 RDP Remote Code Execution CVE 2012-0002
-vuln to smbv2 exploit cve-2009-3103
-vulnerable to ms17-010






