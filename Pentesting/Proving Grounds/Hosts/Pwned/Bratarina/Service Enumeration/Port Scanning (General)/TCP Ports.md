TCP Ports

TCP Ports

1. Get closed and open ports using SYN Stealth scan. 
`sudo nmap -p- 192.168.182.71`
![5ad2cbc5e86285193521c1a1a96b6c36.png](../../../../../_resources/9450c11fd26d47c6956c9f6f0522c81d.png)

We find open ports 22,25,445. Port 53 is closed


2. Scan only the open ports (22,25,445) for service detection
`sudo nmap -p22,25,80,445 -sV 192.168.182.71`
![bb678891f3296481d6835b55f9bb7026.png](../../../../../_resources/b459e3ee82b049ffba79e57624d8feeb.png)

We find that port 25 OpenSMTPD is missing the version number still. Port 445 only has a range of version number 3.x - 4.x


3. Run aggressive scan on the open ports
`sudo nmap -p22,25,80,445 -A 192.168.182.71`
![bee8308f0d8adc8ca05fe60c9803d4b9.png](../../../../../_resources/3b7f5892339c4c10ab110dd1a8cdfd99.png)
![a4191a14434259f06cca7803bb4b212d.png](../../../../../_resources/5806d3265c8f415980c6071dde6eb55c.png)

We see versions:
-OpenSMPTD 2.0.0
-Samba smbd 4.7.6-Ubuntu

4. Run the Nmap NSE scripts for default,safe,auth,vuln
`sudo nmap -p22,25,80,445 --script default,safe,auth,vuln, 192.168.182.71`
![ccfacaab83bd94f522e0aa7229ab684c.png](../../../../../_resources/ee07503c0122466cb6a668a097e08beb.png)
![b5781d73e86453de1d2e922d5da8aaef.png](../../../../../_resources/9ff943ca7f9f483980d366564e452f21.png)
![3c4db6980ea1de32c451011ecfe7a56a.png](../../../../../_resources/c4d82b8be804448d90d3c666a28a477b.png)
![af83f5e573aaf92efe0592ff74936605.png](../../../../../_resources/94a22361a55548c7aab2b4e55c2c35cb.png)
![271c35635d1bf8f0914bbf66dc28a225.png](../../../../../_resources/8356db2ee86142eabbf753959d42bb2f.png)
![0e5f81e1df43dd02a73c4cbd2fd344b2.png](../../../../../_resources/fa9b0a5a5a4640609150cc0b4b9ef56c.png)

Observe:
-port 25, username root
-port 80, there is a session cookie value session=eyJjc3JmX3Rva2VuIjp7IiBiIjoiTldOa056RmlZbUZpTUdFd1pEVTRNMlZsWXpoaU1EVmtPRGd5WldNeFlUaGpNV1JrWldSa05nPT0ifX0.EoApOQ.nISgR0d9wUcTMMm
-service regsvc is vulnerable to dos


